exec = source $HOME/.critical-keys
exec = source $HOME/.env

# Graphics compatibility environment
env = WLR_NO_HARDWARE_CURSORS,1
env = WLR_RENDERER,gles2

# Enable debug logging to troubleshoot config issues
debug {
    disable_logs = false
}

$terminal = kitty

exec-once = swaybg -i $HOME/dev/nix-dotfiles/config/background.jpg
exec-once = source $HOME/.env && source $HOME/.critical-keys && waybar
exec-once = dunst
exec-once = hyprctl setcursor Adwaita 24
exec-once = kanshi
exec-once = systemctl --user start plasma-polkit-agent

# Monitor configuration - simplified for stability
monitor = , preferred, auto, 1

bind = SUPER, T, exec, kitty
bind = SUPER, G, exec, google-chrome-stable
bind = SUPER, E, exec, ~/.config/emacs/bin/doom run
bind = SUPER, F, exec, ferdium
bind = SUPER, Q, exec, nautilus
bind = SUPER, N, exec, networkmanager_dmenu
bind = SUPER, I, exec, idea-community
bind = SUPER_SHIFT, I, exec, pkill -f idea-community
bind = SUPER, Return, exec, wofi --show run
bind = SUPER, X, killactive, ,
bind = SUPER, F10, fullscreen, 1
bind = SUPER_SHIFT, F10, fullscreen, 0
bind = ALT, Tab, workspace, previous
bind = SUPER, Tab, cyclenext, prev
bind = SUPER, 1, workspace, 1
bind = SUPER, 2, workspace, 2
bind = SUPER, 3, workspace, 3
bind = SUPER, 4, workspace, 4
bind = SUPER, 5, workspace, 5
bind = SUPER, 6, workspace, 6
bind = SUPER_SHIFT, 1, movetoworkspacesilent, 1
bind = SUPER_SHIFT, 2, movetoworkspacesilent, 2
bind = SUPER_SHIFT, 3, movetoworkspacesilent, 3
bind = SUPER_SHIFT, 4, movetoworkspacesilent, 4
bind = SUPER_SHIFT, 5, movetoworkspacesilent, 5
bind = SUPER_SHIFT, 6, movetoworkspacesilent, 6
bind = SUPER_SHIFT, f, togglefloating,
bind = SUPER, B, exec, pkill -f waybar
bind = SUPER_SHIFT, B, exec, source $HOME/.env && source $HOME/.critical-keys && waybar
bindr = , XF86AudioMute, exec, pactl set-sink-mute @DEFAULT_SINK@ toggle
bind = , XF86AudioRaiseVolume, exec, pulsemixer --change-volume +5 --unmute
bind = , XF86AudioLowerVolume, exec, pulsemixer --change-volume -5 --unmute
bind = , Print, exec, QT_SCREEN_SCALE_FACTORS="0.833" flameshot gui
bind = SHIFT, Print, exec, wf-recorder -r 50 -p b=20M -c gif -f ~/Videos/recording-$(date -u +"%Y-%m-%d.%H.%M.%S").gif -y -g "$(slurp)"
bind = SUPER_SHIFT, Print, exec, killall -s SIGINT wf-recorder && notify-send "Saved recording at ~/Videos"
bind = , Control_R, exec, $HOME/.diraol/scripts/toggle_mute.sh

bindm = SUPER, mouse:272, movewindow
bindm = SUPER, mouse:273, resizewindow

bindl = , switch:on:Lid Switch, exec, systemctl suspend

# Updated animation syntax
animations {
    enabled = true
    
    animation = workspaces, 1, 0.7, default
    animation = windows, 0, 0, default
}

# Updated binds syntax  
binds {
    allow_workspace_cycles = true
}

# Updated general syntax
general {
    gaps_in = 2
    gaps_out = 2
    border_size = 2
    col.active_border = rgba(33ccffee) rgba(00ff99ee) 45deg
    col.inactive_border = rgba(595959aa)
    
    layout = dwindle
    
    allow_tearing = false
}

xwayland {
    force_zero_scaling = true
}

input {
    kb_layout = us
    kb_variant = intl
    repeat_rate = 60
    repeat_delay = 220

    touchpad {
        natural_scroll = yes
        tap-to-click = true
    }
}

dwindle {
    preserve_split = yes
    pseudotile = yes
    smart_split = yes
}

# Updated workspace syntax
workspace = w[t1], gapsout:0, gapsin:0, bordersize:0, rounding:0
workspace = w[tg1], gapsout:0, gapsin:0, bordersize:0, rounding:0
workspace = 1, monitor:eDP-1
workspace = 2, monitor:eDP-1
workspace = 3, monitor:eDP-1
workspace = 4, monitor:eDP-1
workspace = 5, monitor:eDP-1
workspace = 6, monitor:eDP-1
workspace = 7, monitor:HDMI-A-1

windowrulev2 = workspace 1 silent, class:^(kitty)$
windowrulev2 = workspace 2 silent, class:^(emacs|Emacs)$
windowrulev2 = workspace 3 silent, class:^(Google-chrome|google-chrome)
windowrulev2 = workspace 4 silent, class:^(Ferdium|ferdium)$
windowrulev2 = workspace 5 silent, class:^(org.gnome.Nautilus)$
windowrulev2 = workspace 5 silent, class:^(zoom)$
windowrulev2 = workspace 5 silent, class:^(Vesktop|vesktop)$
windowrulev2 = workspace 5 silent, class:^(lutris)$
windowrulev2 = workspace 5 silent, title:^(Godot|godot)$
windowrulev2 = workspace 6 silent, class:^(Gimp|gimp)$
windowrulev2 = workspace 6 silent, class:^(jetbrains-idea-ce)$
windowrulev2 = stayfocused, class:^(pinentry-) # fix pinentry losing focus

# Godot
